<!DOCTYPE html>
<html lang="en">

<head>
     {{> head}}
    <title>SmartLists</title>
</head>

<body style="text-align: center;">
    {{> nav navState=navState}}
    <div class="content">
        {{{body}}}
    </div>

    <script src="/assets/jquery.min.js"></script>
    <script src="/assets/js/bootstrap.min.js"></script>
    <script src="/assets/handlebars.min.js"></script>
    <script src="/assets/partials/bubble.js"></script>
    <script src="/assets/index.js"></script>
    <script>

        $(document).ready(function() {

            // Requests user's playlist data (only on /start)
            if (location.pathname == '/start') {
                $.ajax({
                    'type': 'GET',
                    'url': '/api/playlists',
                    'dataType': 'json'
                }).done(function(data) {
                    var userPlaylists = data.result.playlists;
                    InsertBubbles(userPlaylists);
                    // Animation must be played after the bubbles are finished being added.
                    animateFlex("item", "right");
                }).fail(function(err) {
                    console.log('Error fetching user-playlists');
                });
            }
            // This block is a bandaid fix for now.
            else if (location.pathname == '/') {
                animateFlex("item", "right");
            }

            console.log(location.pathname);

            // Sends search requests to the server
            $("#playlist-search-form").submit(function(event) {
                var formData = {
                    'search': $('#playlist-search-input').val()
                };

                $.ajax({
                    'type': 'POST',
                    'url': location.origin + location.pathname,
                    'data': formData,
                    'dataType': 'json',
                    'encode': 'true'
                }).done(function(data) {
                    console.log(data);
                });
                event.preventDefault();
            });


        });


        var scrollContainer = document.getElementById('right');
        document.body.addEventListener("wheel", (evt) => {
            evt.preventDefault();
            scrollContainer.scrollLeft += evt.deltaY;
            scrollContainer.scrollLeft += evt.deltaX;
        }, {
            passive: false
        });
    </script>
</body>

</html>